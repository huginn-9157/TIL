# BI構築 - 販売管理

上流工程について

## 設計前

- ソースデータ分析
  - 業務系システムから取得可能かどうか
    - 取得できない項目はETL処理時に追加するか、
    - BIツールの機能でExcelから読み取る等
      - 特に以下の項目は[ODS](./BI.md#operational-data-source-od)を作成して、そこから取得しなければならないケースが多い
        - 予算等の計画データ
        - 週、月、四半期等の時間の区切り
- 要件定義
  - どんな分析がしたいのか
    - こればかりは具体案が無いと何とも
    - 例
      - 時間
        - 年度別や月別に、直近３年の実績値を分析
      - 製品
        - カテゴリ別やシリーズ別に分析
      - チャネル
        - 店舗販売、ネット販売といったチャネル別
  - 上の例で実績値の分析に使用する数字は
    - 売上金額（製品が販売された金額）
    - コスト（製品の仕入金額）
- 使用するデータウェアハウスのER図を作成
- 管理ポイントと鮮度分析を行う
  - 管理ポイント
    - データの粒度と分析に使用する項目
      - 上の例だと、年・月・製品カテゴリ・シリーズ・製品・チャネル
    - 管理項目＝集計項目？
      - 売上金額とコスト
    - データの粒度が異なる組み合わせがあるかどうかをチェック
  - 鮮度
    - 直近３年間を調べたい場合は鮮度＝３年間
    - 要はどれだけ古いデータが必要になるかどうかということ
- ディメンショナルモデリング
  - 次元ごとにドリルダウン・アップするものを並べる
    - 年→月
    - カテゴリ→シリーズ→製品
    - チャネル
  - 下図では最下層に位置するものを管理ポイントとし、集計項目を実績ファクトとしている
  
  ```plantuml
  @startuml
  
  folder 管理項目 [
    集計項目
    ----
    売上金額
    コスト
  ]
  cloud 実績ファクト

  管理項目 -> 実績ファクト

  @enduml
  ```

  ```plantuml
  @startuml

  cloud 実績ファクト
  storage 時間
  storage 製品
  storage チャネル

  時間 -do-> 実績ファクト
  製品 -le-> 実績ファクト
  チャネル -ri-> 実績ファクト
  
  @enduml
  ```

- ソースデータ分析と、ディメンショナルモデリングを合わせる
  - DWHにデータがあるかどうか

----

## 設計

- システム方針設計
  - RDB設計
    - 表示するのにどんなDB構造すれば良いか
  - ETL処理（データソースエリアを定義）
    - 上のDBにするにはどういじればよいか
  - 多次元DB設計
    - ディメンショナルモデリングのマトリクスを書く
    - 字面を見ると意味わからんが、
      - 年、４半期、月等のドリルダウンの動きを階層数や次元数と一緒に表にすること
  - 画面設計
    - 画面上の項目毎の初期表示
    - どれを選択可能にするか等
- 運用設計
